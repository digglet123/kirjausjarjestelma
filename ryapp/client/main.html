<template name="main">
	<head>
	  <title>ryapp</title>
	</head>
	<body>
		<div class="container">
			{{> navigation}}
			{{> Template.dynamic template=main}}
	    </div>
	</body>
</template>


<template name="navigation">
	<nav class = "top-nav">
		<ul>
			<a class ="nav-item" href="/kirjaus">Kirjaus</a>
			<a class ="nav-item" href="/arkisto">Arkisto</a>
			<div class = "login">
				{{> loginButtons}}
			</div>
		</ul>
	</nav>
</template>


<template name="KirjausLayout">
	<header>
		<h1>Tuotteiden kirjaus</h1>
	</header>
	{{#if currentUser}}
		<div class="top">
			<form class="new-kirjaus">
				{{>typeform}}
				<input class = "input" id = "pr" type="number" step="0.01" name="prodPrice" placeholder ="hinta €/kpl" required="true" autocomplete="off"> 
				{{> DatePicker}}
				<input class = "green_btn" id = "add" type="submit" value="lisää">
			</form>
		</div>
		{{#if hasItems}}
			<hr>
			<div class="bottom">
				<table class="mainTable">
					<tr>
						<th>tuote</th>
						<th>hinta</th>
						<th>päivämäärä</th>
						<th>kpl</th>
					</tr>
				    {{#each kirjaukset}}
			            {{> kirjaus}}
			        {{/each}}
				</table>			
			</div>
			<hr>
			<footer>
				<label id = "yht">Yhteensä:</label>
				{{> KirjausSumma}}
				<button class = "green_btn" id = "ins" >kirjaa tuotteet</button>
			</footer>
		{{/if}}
	{{else}}
		<div class="message"><label>Kirjaudu sisään tehdäksesi kirjauksia.</label></div>
	{{/if}}	
</template>


<template name="KirjausSumma">
	<label class = "total" id = "sum">0.00 €</label>
</template>


<template name="ArkistoLayout">
	<header>
		<h1>Arkisto</h1>
	</header>
	{{#if Template.subscriptionsReady}}
		<div class = "top">
			<h2 class ="tag">Tilastot</h2>
			<table class="secondaryTable">
				<tr>
					<th>kirjaaja</th>		
					<th>summa</th>
					<th>viimeisin kirjaus</th>
				</tr>
				{{#each kirjaajat}}
					<tr>
						<td><label>{{username}}</label></td>				
						<td><label class="total">{{kirjaajaSumma this}} €</label></td>	
						<td>{{viimeinenKirjaus this}}</td>	
					</tr>
				{{/each}}
				<tr>
					<td><label>yhteenveto</label></td>
					<td><label class="total">{{kokonaisSumma}} €</label></td>
					<td>{{viimeisinKirjaus}}</td>
				</tr>
			</table>		
		</div>
		<hr>
		<h2 class="tag">Kirjaukset</h2>
		<div class="control">
			<div class="sort">
				<label>Järjestä:</label>
				<form>
					<input type="radio" name="sort" value="kirjaus" id ="kirjaus" checked>Kirjauspäivän mukaan<br>
					<input type="radio" name="sort" value="osto" id ="osto">Ostopäivän mukaan<br>
				</form>			
			</div>
			<div class="filter">
				<label>Näytä:</label>
				<select id="filter">
					{{#each kirjaajat}}
				  		<option>{{username}}</option>
				  	{{/each}}
				  	<option selected>kaikki</option>
				</select>
			</div>
			<div class="download">
				{{>lataus}}
			</div>
		</div>
		<div class= "bottom">
			<table class="mainTable">
				<tr>
					<th>tuote</th>
					<th>hinta</th>
					<th>kpl</th>
					<th>päivämäärä</th>
					<th>kirjaaja</th>
				</tr>
			    {{#each arkistot}}
		            {{> arkisto}}
		        {{/each}}
			</table>		
		</div>
	{{else}}
		<div class="message"><label>Loading...</label></div>
	{{/if}}
</template>


<template name="lataus">
	<a href="#" class="btn btn-default" role="button" id="download">Lataa CSV</a>
</template>


<template name="DatePicker">
	<input class = "input" id = "dt" type="text" name="purchaseDate" required="true">
</template>


<template name="typeform">
	<input id = "nm" class = "form-control typeahead" type="text" name="prodName" placeholder ="tuotteen nimi" data-source = "etsi" autocomplete="off" spellcheck="off" required="true" autofocus data-autocomplete="auto" data-select="auto">
</template>


<template name="kirjaus">
	<tr>
		<td>{{name}}</td>
	    <td>{{price}} €</td>
	    <td>{{prettyDate date}} </td>
	    <td><input class = "stepper" id = "amnt" type="number" name="amount"  value = {{amount}} required="true" autocomplete="off" min = "0" max = "9" onkeydown="return false"  unselectable="on" onfocus="this.blur()" onselectstart="return false;"></td>
	</tr>
</template>


<template name="arkisto">
	<tr>
		<td>{{name}}</td>
	    <td>{{price}} €</td>
	    <td>{{amount}}</td>
	    <td>{{prettyDate date}}</td>
	    <td><label id = "name">{{Owner.username}}</label>{{#if isOwner}}<button id = "delete">poista</button>{{/if}}</td>
	</tr>
</template>
